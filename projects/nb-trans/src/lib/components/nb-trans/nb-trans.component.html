<ng-container *ngTemplateOutlet="sentenceListTpl; context: { list: sentenceList }" />

<ng-template #sentenceListTpl let-list="list">
  @for (item of list; track item) {
    @switch (item | nbSentenceItemType) {
      @case (SentenceItemEnum.STR) {
        <ng-container [ngTemplateOutlet]="strTpl" [ngTemplateOutletContext]="{ content: item }" />
      }
      @case (SentenceItemEnum.COMP) {
        <ng-container [ngTemplateOutlet]="compTpl" [ngTemplateOutletContext]="{ content: item }" />
      }
      @case (SentenceItemEnum.MULTI_COMP) {
        <ng-container
          [ngTemplateOutlet]="multiCompTpl"
          [ngTemplateOutletContext]="{ content: item }" />
      }
    }
  }
</ng-template>

<ng-template #strTpl let-content="content">{{ content | nbTransContent: params }}</ng-template>

<!-- because the content may be rendered directly, or input as a component prop, so here should be as a templateRef. -->
<!-- render the templateRef component of components with content, and the content type in context is string -->
<ng-template #compTpl let-data="content">
  <ng-container
    *ngTemplateOutlet="
      components[data.index] | nbTplContent;
      context: { content: data.content | nbTransContent: params }
    " />
</ng-template>

<!-- there are multiple components, so should render the templateRef component firstly,  -->
<!-- then making the sentenceListTpl as content prop, so user can render it more flexible -->
<ng-template #multiCompTpl let-data="content">
  <ng-container
    *ngTemplateOutlet="
      components[data.index] | nbTplContent;
      context: { content: sentenceListTpl, list: data.list }
    " />
</ng-template>
